<div class="container my-5">
  <div>
    <div class ="px-3">

      <h1> Welcome <%= @user.first_name %> !</h1>
  <!-- Section: list of item to sell -->

      <h2>Current items on sell</h2>
    </div>

<!-- table for Items on sell -->
    <div class="card shadow-none">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Ref no.</th>
            <th scope="col">Picture</th>
            <th scope="col">Title</th>
            <th scope="col">Category</th>
            <th scope="col">Location</th>
            <th scope="col">Price</th>

            <th scope="col">Posting date</th>
            <th scope="col">Status</th>
          </tr>
        </thead>
<!-- body of item on sell -->
        <% @user.items.each do |item| %>
        <tbody>
          <tr>
            <th scope="row"><%= item.id %></th>
            <td><%= cl_image_tag item.photo, class:"item-photo" %></td>
            <td><%= item.title %></td>
            <td><%= item.category%></td>
            <td><%= item.location %></td>
            <td><%= item.price %> €</td>
            <td><%= item.created_at.strftime("%Y-%m-%d") %></td>
            <td>
              <% if item.transactions.where(status: 'pending').any? %>
                <p>Pending your approval
                  <%= link_to accept_item_transaction_path(item, item.transactions.where(status: 'pending').where(user: current_user).last), method: :patch do%>
                    <i class="fas fa-check-circle text-success"></i>
                  <% end %>
                  <%= link_to decline_item_transaction_path(item, item.transactions.where(status: 'pending').where(user: current_user).last), method: :patch do%>
                    <i class="fas fa-times-circle text-danger"></i>
                  <% end %>
                </p>

              <% else %>
                <p>For sell</p>
              <% end %>
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>
<!-- end of the Items on sell table -->



<h2>Pending purchases</h2>

<h2>Sold item work in progress</h2>
<!-- Section: Historical purchase -->
    <div class ="px-3" >
      <h2>Historical purchases</h2>
    </div>

<!-- table for historical purchase -->
    <div class="card shadow-none">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Ref no.</th>
            <th scope="col">Name</th>
            <th scope="col">Description</th>
            <th scope="col">Price</th>
            <th scope="col">Date of purchase</th>
            <th scope="col">Details</th>
          </tr>
        </thead>
<!-- body of the purchase -->
        <% @transactions.each do |transaction| %>
        <tbody>
          <tr>
            <th scope="row"><%= transaction.item_id %></th>
            <td><%= transaction.item.user.first_name %>
                <%= transaction.item.user.last_name %></td>
            <td><%= transaction.item.description %></td>
            <td><%= transaction.item.price %> euros</td>
            <td><%= transaction.item.updated_at.strftime("%Y-%m-%d") %></td>
            <td><%= link_to item_path(transaction.item) do %>
                <p> <i class=“fas fa-glasses”></i> See</p>
                <% end %></td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>
<!-- end of the historical purchase table -->
  </div>
</div>
